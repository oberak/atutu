<!doctype html>
<html lang="zxx">
<head>
    <% include ../partial/head.ejs %>
</head>
<style media="screen">
#goal{
    border: none;
}
#btnModify{
    background-color: #3f41a3;
}
#btnDelete{
    background-color: #cc1010;
    }
#btnStart{
  background-color: #090df4;
  }
b{
  font-size: 2rem;
}
</style>
<body >

    <div id="wrapper" class="wrapper">

        <!-- BEGIN HEADER -->
        <% include ../partial/header.ejs %>
        <!-- END HEADER -->

        <!-- BEGIN MAIN CONTENT -->
        <main class="site-content">

<div class="container no-top-padding">
	<ol class="breadcrumb">
		<li><a href="#">Home</a></li>
		<li class="active">Causes</li>
	</ol>
  <header class="page-header">
    <h1>Campaign Confirm View</h1>
  </header>
  <!-- <form class="checkout-form form-horizontal" id="frm" method="post" action="/campaign/confirm" name="frm" enctype="multipart/form-data"> -->
	<div class="post">
		<header class="post-header">
			<h2><%= camp.title %></h2>
			<div class="post-meta">
				<div class="post-meta-item">
					<i class="fa fa-folder-o"></i> Category name
				</div>
			</div>
		</header>
		<div class="row">
			<div class="col col-lg-9 col-md-9">
				<header class="secondary-post-header">
					<div class="post-thumb">
						<img src="<%=camp.imgUrl%>" alt="User photo" onerror="this.src='/images/user.png'">
					</div>
					<div class="post-header-inner">
						<div class="cause-progress">
							<div class="cause-progress-val">
								<div class="cause-progress-raised">Raised <span><%= camp.raised.credit.amount%> Kyats</span></div>
								<div class="cause-progress-goal">Goal <span><%= camp.goal %>,000 kyats</span></div>
							</div>
              <div class="progress">
                <div class="progress-bar" id="real" role="progressbar" style="width: 25%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                <div class="progress-bar-info" id="virtual" role="progressbar" style="width: 25%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
              </div>
						</div>
					</div>
				</header>

        <script type="text/javascript">
          function progressFun(i) {
            var real = Math.floor(((<%= camp.raised.credit.amount%>)/(<%= camp.goal %>))* 100);// 5000 is amount , 15000 is goal
            document.getElementById('real'+i).style.width = String(real)+'%' ;
            var virtual = Math.floor(((<%= camp.raised.reserved.amount%>)/(<%= camp.goal %>))* 100); //1000 is virtaul ,15000 is Goal
            document.getElementById('virtual'+i).style.width = String(virtual)+'%' ;
          }
          progressFun(<%= i %>);
        </script>

        <div>
          <h3>Brief</h3>
          <%= camp.brief %>
        </div>
        <hr>
        <div>
          <h3>Story</h3>
          <%= camp.story.text %>
        </div>
        <p></p>

				<ul class="nav nav-tabs" role="tablist">
					<li role="presentation" class="active">
            <div class="post-meta-item">
              <center><i class="fa fa-user-o"></i> 15</center>
            </div>
						<a href="#donorlist" aria-controls="donorlist" role="tab" data-toggle="tab">Donor List</a>
					</li>
					<li role="presentation">
            <div class="post-meta-item">
              <center><i class="fa fa-comments"></i> 16</center>
            </div>
						<a href="#comments" aria-controls="comments" role="tab" data-toggle="tab">Comments</a>
					</li>
				</ul>
				<div class="tab-content">
					<div role="tabpanel" class="tab-pane active" id="donorlist">
					</div>
					<div role="tabpanel" class="tab-pane" id="comments">
					</div>
				</div>

				<footer class="entry-footer">
					<div class="row">
						<div class="col col-lg-6">
					</div>
				</footer>
			</div>
			<div class="col col-lg-3 col-md-3">
				<div class="post-details">
          <div class="widget">
              <form class="search-form">
                  <div class="form-group">
                      <input class="form-control" type="search" required placeholder="Search...">
                      <button><i class="fa fa-search"></i></button>
                  </div>
              </form>
          </div>

          <div>
            <select class="form-control">
              <option value="0">Select Categories:</option>
              <option value="1">Audi</option>
              <option value="2">BMW</option>
              <option value="3">Citroen</option>
              <option value="4">Ford</option>
              <option value="5">Honda</option>
            </select>
          </div>

					<p></p>

          <div class="post-details-item">
						<h3>Goal</h3>
						<p><input type="text" id="goal" name="" value="<%= camp.goal %>0,000 kyats" readonly></p>
					</div>
          <p></p>

					<h3 class="post-details-item">Creator</h3>
					<div class="post-author">
						<div class="post-author-photo">
							<a href=""><img src="/images/avatar-1.jpg" width="100" height="100" alt=""></a>
						</div>
						<a href=""><b>John Smith</b></a><br> 10 campaigns
					</div>

					<h3 class="post-details-item">Tags</h3>
					<div class="tags">
            <% for(var i = 0; i< camp.tags.length; i++ ){%>
              <a href=""><%= camp.tags[i] %></a>
            <%}%>
					</div>
          <h3 class="post-details-item">End date</h3>
					<div>
						<%= camp.dueDate %>
					</div>
          <p></p>
          <div class="post-details-item">
						<h3>Address</h3>
						<p><%= camp.address.region %> &nbsp&nbsp&nbsp <%= camp.address.city %> &nbsp&nbsp&nbsp <%= camp.address.other %></p>
					</div>
          <p></p>
          <center><b><a href="/campaign/list" id="list">Go to Campaign list</a></b></center>

				</div>
			</div>
		</div>
	</div>

          	<hr>
            <div class="text-center">
              <button type="button" class="btn btn-lg btn-primary" id="btnDelete">DELETE</button>
              <button type="button" class="btn btn-lg btn-primary" id="btnModify">MODIFY</button>
              <button type="button" class="btn btn-lg btn-primary" id="btnStart">START</button>
            </div>

            <!-- </form> -->
          </div>
        </main>
        <!-- END MAIN CONTENT -->
        <!-- BEGIN FOOTER -->
        <% include ../partial/footer.ejs %>
        <!-- END FOOTER -->
    </div>
    </body>
    <!-- Gmaps API -->
    <script src="http://maps.google.com/maps/api/js"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/quill/1.3.6/quill.js" charset="utf-8"></script> --> -->
    <script src="/scripts/map-objects-data.js"></script>
    <!-- Plugins js -->
    <script src="/scripts/plugins.js"></script>
    <!-- Main js -->
    <script src="/scripts/main.js"></script>



    <script type="text/javascript">
      $('#btnModify').click(function () {
        location.href = '/campaign/modify/<%=camp._id%>';
      });

      $('#btnStart').click(function () {
        location.href = '/campaign/detail/<%=camp._id%>';
      });

      $('#btnDelete').click(function () {
        if(confirm('Are you sure? After click to DELETE button, your campaign will delete.'))
        location.href= '/campaign/delete/'+'<%= camp._id %>';
      });
    </script>

      <script type="text/javascript">
        var toolbarOptions = [
          ['bold', 'italic', 'underline'], // toggled buttons
          ['blockquote'],

          [{
            'header': 1
          }, {
            'header': 2
          }], // custom button values
          [{
            'list': 'ordered'
          }, {
            'list': 'bullet'
          }],
          [{
            'script': 'sub'
          }, {
            'script': 'super'
          }], // superscript/subscript
          [{
            'indent': '-1'
          }, {
            'indent': '+1'
          }], // outdent/indent
          [{
            'direction': 'rtl'
          }], // text direction

          [{
            'size': ['small', false, 'large', 'huge']
          }], // custom dropdown
          [{
            'header': [1, 2, 3, 4, 5, 6, false]
          }],

          [{
            'color': []
          }, {
            'background': []
          }], // dropdown with defaults from theme
          [{
            'font': []
          }],
          [{
            'align': []
          }],

          ['clean'] // remove formatting button
        ];

        // var quill = new Quill('#editor', {
        //   modules: {
        //     toolbar: toolbarOptions
        //   },
        //   theme: 'snow'
        // });

        $(function() {
          function readURL(input) {
            if (input.files && input.files[0]) {
              var reader = new FileReader();
              reader.onload = function(e) {
                $('#photo').attr('src', e.target.result);
              }
              reader.readAsDataURL(input.files[0]);
            }
          }
          $("#uploadImg").change(function() {
            readURL(this);
          });
        });

        btnStart.onclick = function() {
          var formData = new FormData(document.querySelector('#frm'));
          formData.append('contents', quill.container.firstChild.innerHTML);
          formData.append('text', quill.getText());
          $.ajax('/campaign/modify', {
            method: 'POST',
            data: formData,
            processData: false,
            contentType: false,
            success: function(rtn) {
              location.href= "/campaign/view/"+rtn.id;
            },
            error: function(err) {
              console.log(err);
            },
            complete: function() {
              console.log('complate');
            },
          });
        }
      </script>

</html>
